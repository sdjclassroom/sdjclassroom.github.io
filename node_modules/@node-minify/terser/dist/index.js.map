{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/*!\n * node-minify\n * Copyright(c) 2011-2024 Rodolphe Stoclin\n * MIT Licensed\n */\n\n/**\n * Module dependencies.\n */\nimport type { MinifierOptions } from \"@node-minify/types\";\nimport { utils } from \"@node-minify/utils\";\n// @ts-expect-error moduleResolution:nodenext issue 54523\nimport { minify } from \"terser\";\n\ntype OptionsTerser = {\n    sourceMap?: { url: string };\n};\n\ntype SettingsTerser = {\n    options: OptionsTerser;\n};\n\ntype MinifierOptionsTerser = {\n    settings: SettingsTerser;\n};\n\n/**\n * Run terser.\n * @param settings Terser options\n * @param content Content to minify\n * @param callback Callback\n * @param index Index of current file in array\n * @returns Minified content\n */\nconst minifyTerser = async ({\n    settings,\n    content,\n    callback,\n    index,\n}: MinifierOptions & MinifierOptionsTerser) => {\n    try {\n        const contentMinified = await minify(content ?? \"\", settings?.options);\n        if (\n            contentMinified.map &&\n            typeof settings?.options?.sourceMap?.url === \"string\"\n        ) {\n            utils.writeFile({\n                file: settings.options.sourceMap.url,\n                content: contentMinified.map,\n                index,\n            });\n        }\n        if (settings && !settings.content && settings.output) {\n            utils.writeFile({\n                file: settings.output,\n                content: contentMinified.code,\n                index,\n            });\n        }\n        if (callback) {\n            return callback(null, contentMinified.code);\n        }\n        return contentMinified.code;\n    } catch (error) {\n        return callback?.(error);\n    }\n};\n\n/**\n * Expose `minifyTerser()`.\n */\nminifyTerser.default = minifyTerser;\nexport = minifyTerser;\n"],"mappings":";;;AAUA,mBAAsB;AAEtB,oBAAuB;AAsBvB,IAAM,eAAe,OAAO;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,MAA+C;AAC3C,MAAI;AACA,UAAM,kBAAkB,UAAM,sBAAO,WAAW,IAAI,UAAU,OAAO;AACrE,QACI,gBAAgB,OAChB,OAAO,UAAU,SAAS,WAAW,QAAQ,UAC/C;AACE,yBAAM,UAAU;AAAA,QACZ,MAAM,SAAS,QAAQ,UAAU;AAAA,QACjC,SAAS,gBAAgB;AAAA,QACzB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,QAAI,YAAY,CAAC,SAAS,WAAW,SAAS,QAAQ;AAClD,yBAAM,UAAU;AAAA,QACZ,MAAM,SAAS;AAAA,QACf,SAAS,gBAAgB;AAAA,QACzB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,QAAI,UAAU;AACV,aAAO,SAAS,MAAM,gBAAgB,IAAI;AAAA,IAC9C;AACA,WAAO,gBAAgB;AAAA,EAC3B,SAAS,OAAO;AACZ,WAAO,WAAW,KAAK;AAAA,EAC3B;AACJ;AAKA,aAAa,UAAU;AACvB,iBAAS;","names":[]}